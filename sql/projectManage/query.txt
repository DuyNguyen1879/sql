SELECT name FROM employees
WHERE name NOT IN
(SELECT DISTINCT e.NAME
FROM employees AS e
JOIN
project_status AS p
ON e.id = p.emp_id
WHERE p.status = 1
);

+--------+
| NAME   |
+--------+
| user b |
| user c |
+--------+
2 rows in set (0.00 sec)


SELECT e.name FROM employees e
WHERE e.id IN
(SELECT DISTINCT emp_id
FROM technologies t
JOIN
proj_tech pt
ON t.id = pt.tech_id
NATURAL JOIN
project_status pp
WHERE t.name IN('html','javascript','ios')
GROUP BY emp_id
HAVING COUNT(DISTINCT t.name) >=3
);

+--------+
| name   |
+--------+
| user a |
| user b |
| user c |
| user d |
+--------+
4 rows in set (0.00 sec)


select distinct t.name from employees e
join
project_status ps
on e.id = ps.emp_id
natural join
proj_tech pt
join
technologies t
on pt.tech_id = t.id
where e.name = "user b"
group by t.id
having count(t.id) >=3 ;

Empty set (0.00 sec)


start transaction;
Query OK, 0 rows affected (0.00 sec)

select count(*) into @max_count
from employees e
join
project_status ps
on e.id = ps.emp_id
natural join
proj_tech pt
join
technologies t on pt.tech_id = t.id
where t.name = "android" and ps.status = 0
group by e.id
order by count(*)
desc limit 1;

Query OK,x 1 row affected (0.00 sec)

select e.name from employees e
join
project_status ps
on e.id = ps.emp_id
natural join
proj_tech pt
join
technologies t
on pt.tech_id = t.id
where t.name = "android" and ps.status = 0
group by e.id
HAVING count(*) = @max_count; 

+--------+
| name   |
+--------+
| user b |
+--------+
1 row in set (0.00 sec)

